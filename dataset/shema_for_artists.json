///artists

{
   "name": "David Cook",
   "gender": "Male",
   "area": "United States",
   "deleted": false,
   "mbid": "966e1095-b172-415c-bae5-53f8041fd050",
   "_id": "966e1095-b172-415c-bae5-53f8041fd050",
   "slug_name": "david-cook",
   "slug_postfix": {
      "$numberLong": 0
   },
   "disambiguation_comment": "American Idol",
   "albums": [
      {
         "cover_image_url": "http://coverartarchive.org/release/78d08954-e79f-4a80-929d-71cc0ecc7b9d/6964754870.jpg",
         "slug": "analog-heart-0",
         "name": "Analog Heart",
         "id": "78d08954-e79f-4a80-929d-71cc0ecc7b9d"
      }
   ],
   "profile_image_url": "https://upload.wikimedia.org/wikipedia/commons/a/a0/David_Cook_Toads_cropped.jpg",
   "images_urls": ["https://upload.wikimedia.org/wikipedia/commons/a/a0/David_Cook_Toads_cropped.jpg"],
   "begin_date": {
      "$dateDay": "1982-12-20"
   },
   "rating": 2.919355
}


add jar /opt/mapr/hive/hive-2.3/hcatalog/share/hcatalog/hive-hcatalog-core-2.3.3-mapr-1901.jar;


CREATE EXTERNAL TABLE artists_load (
  `_id` string,
  albums array<struct<cover_image_url:string, id:string, name:string, slug:string>>,
  area string,
  deleted boolean,
  disambiguation_comment string,
  gender string,
  images_urls array<string>,
  mbid string,
  name string,
  profile_image_url string,
  rating double,
  slug_name string
ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe' 
STORED AS TEXTFILE; 


LOAD DATA LOCAL INPATH '/tmp/dataset/artists.json' OVERWRITE INTO TABLE artists_load;


CREATE TABLE artists (
  `_id` string,
  albums array<struct<cover_image_url:string, id:string, name:string, slug:string>>,
  area string,
  deleted boolean,
  disambiguation_comment string,
  gender string,
  images_urls array<string>,
  mbid string,
  name string,
  profile_image_url string,
  rating double,
  slug_name string
STORED BY 'org.apache.hadoop.hive.maprdb.json.MapRDBJsonStorageHandler' 
TBLPROPERTIES("maprdb.table.name" = "/artists","maprdb.column.id" = "id"); 


INSERT INTO TABLE artists select 
`_id` string,
  albums,
  area,
  deleted,
  disambiguation_comment,
  gender,
  images_urls,
  mbid,
  name,
  profile_image_url,
  rating,
  slug_name
from artists_load;