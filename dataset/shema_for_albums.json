///albums

{
   "name": "Runnin' Wild",
   "barcode": "016861796327",
   "status": "Official",
   "packaging": "",
   "language": "eng",
   "script": "28",
   "mbid": "0a1aa2f3-b3bf-4527-b235-1027888e6f7f",
   "_id": "0a1aa2f3-b3bf-4527-b235-1027888e6f7f",
   "slug_name": "runnin-wild",
   "slug_postfix": {
      "$numberLong": 2
   },
   "MBID": "0a1aa2f3-b3bf-4527-b235-1027888e6f7f",
   "artists": [
      {
         "rating": 2.7837837,
         "profile_image_url": "https://upload.wikimedia.org/wikipedia/commons/a/a0/AirbourneAtTampere.jpg",
         "slug": "airbourne-0",
         "name": "Airbourne",
         "id": "5365f55c-b1e1-48f9-b09f-078f7a14cb1f"
      }
   ],
   "tracks": [
      {
         "id": "c0ffeea5-ffc6-316f-819c-13958450e9be",
         "name": "Diamond in the Rough",
         "length": {
            "$numberLong": 173960
         },
         "position": {
            "$numberLong": 4
         },
         "mbid": "c0ffeea5-ffc6-316f-819c-13958450e9be",
         "MBID": "c0ffeea5-ffc6-316f-819c-13958450e9be"
      }
   ],
   "cover_image_url": "http://coverartarchive.org/release/0a1aa2f3-b3bf-4527-b235-1027888e6f7f/929069980.jpg",
   "images_urls": [
      "http://coverartarchive.org/release/0a1aa2f3-b3bf-4527-b235-1027888e6f7f/929079251.jpg"
   ],
   "released_date": {
      "$dateDay": "2007-6-25"
   },
   "rating": 2.631579
}


add jar /opt/mapr/hive/hive-2.3/hcatalog/share/hcatalog/hive-hcatalog-core-2.3.3-mapr-1901.jar;


CREATE EXTERNAL TABLE albums_load (
  `_id` string,
  artists array<struct<id:string, name:string, profile_image_url:string, rating:double, slug:string>>,
  barcode string,
  cover_image_url string,
  images_urls array<string>,
  language string,
  mbid string,
  name string,
  packaging string,
  rating double,
  script string,
  slug_name string,
  status string,
  tracks array<struct<id:string, mbid:string, name:string>>)
ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe'
STORED AS TEXTFILE; 


LOAD DATA LOCAL INPATH '/tmp/dataset/albums.json' OVERWRITE INTO TABLE albums_load;


CREATE TABLE albums (
  `_id` string,
  artists array<struct<id:string, name:string, profile_image_url:string, rating:double, slug:string>>,
  barcode string,
  cover_image_url string,
  images_urls array<string>,
  language string,
  mbid string,
  name string,
  packaging string,
  rating double,
  script string,
  slug_name string,
  status string,
  tracks array<struct<id:string, mbid:string, name:string>>)
STORED BY 'org.apache.hadoop.hive.maprdb.json.MapRDBJsonStorageHandler' 
TBLPROPERTIES("maprdb.table.name" = "/albums","maprdb.column.id" = "_id"); 


INSERT INTO TABLE albums select
  `_id` string,
  artists,
  barcode,
  cover_image_url,
  images_urls,
  language,
  mbid,
  name,
  packaging,
  rating,
  script,
  slug_name,
  status,
  tracks from albums_load;






